rule malware
{
       strings:
          $a = "MZ"
          $foo1 = "WWWWWPj"
          $foo2 = "OpenSCManagerA"
          $foo3 = ";22dV::tN"
          $foo4 = "_local_unwind2"
          $foo5 = "2+( VPOL"
          $foo6 = "GlobalAlloc"
          $foo7 = "VirtualProtect"
          $foo8 = "@Pbmx~P"
          $foo9 = "FreeLibrary"
          $foo10 = "^Fr`+:&"
          $foo11 = "VirtualAlloc"
          $foo12 = "CreateDirectoryW"
          $foo13 = ">k_I[$"
          $foo14 = "msg/m_english.wnryF"
          $foo15 = "StartServiceA"
          $foo16 = ":*>B=Ox"
          $foo17 = "OpenMutexA"
          $foo18 = "GetFullPathNameA"
          $foo19 = "RegSetValueExA"
          $foo20 = "msg/m_french.wnry"
          $foo21 = "DeleteFileW"
          $foo22 = "QeTbF~ZiKw"
          $foo23 = "SbE\\lHtQeF"
          $foo24 = "Q~TbFwZiK"
          $foo25 = "CreateFileW"
          $foo26 = ".?AVtype_info@@"
          $foo27 = "CryptDecrypt"
          $foo28 = "=j&&LZ66lA??~"
          $foo29 = "F~TbKwZi"
          $foo30 = "incorrect data check"
          $foo31 = "tasksche.exe"
          $foo32 = "MoveFileW"
          $foo33 = "unknown compression method"
          $foo34 = "??1exception@@UAE@XZ"
          $foo35 = "realloc"
          $foo36 = "SetCurrentDirectoryA"
          $foo37 = "WriteFile"
          $foo38 = "b4(X2;ey"
          $foo39 = "__p__commode"
          $foo40 = "MultiByteToWideChar"
          $foo41 = "LoadLibraryA"
          $foo42 = "\\6tGuzF"
          $foo43 = "%%Jo..\\r"
          $foo44 = "4$8,9-6'.6$:#?*1hHpXeA~SrZlN"
          $foo45 = "PPxD<<%"
          $foo46 = "kernel32.dll"
          $foo47 = "&%^W6)."
          $foo48 = "CryptImportKey"
          $foo49 = "HeapFree"
          $foo50 = "_except_handler3"
          $foo51 = "WaitForSingleObject"
          $foo52 = "V,YYG;~"
          $foo53 = "Ud|JZ|BE"
          $foo54 = "_CxxThrowException"
          $foo55 = "data error"
          $foo56 = "??0exception@@QAE@ABQBD@Z"
          $foo57 = "_acmdln"
          $foo58 = "OLEAUT32.dll"
          $foo59 = ";u>H4q7.c"
          $foo60 = "GetModuleHandleA"
          $foo61 = "incomplete literal/length tree"
          $foo62 = "OpenServiceA"
          $foo63 = "CryptReleaseContext"
          $foo64 = "attrib +h ."
          $foo65 = "inflate 1.1.3 Copyright 1995-1998 Mark Adler"
          $foo66 = "12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw"
          $foo67 = "insufficient memory"
          $foo68 = "$`GnP+%<g"
          $foo69 = "TaskStart"
          $foo70 = "msg/m_chinese (traditional).wnry"
          $foo71 = "[_:L	x86"
          $foo72 = "ReadFile"
          $foo73 = "Bb..fO3"
          $foo74 = "qDj$bIU"
          $foo75 = "k|_^][Y"
          $foo76 = "invalid distance code"
          $foo77 = "wcsrchr"
          $foo78 = "GetFileSizeEx"
          $foo79 = "L)b7=a`"
          $foo80 = "__CxxFrameHandler"
          $foo81 = "_stricmp"
          $foo82 = "[4+G[Tnr"
          $foo83 = "13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94"
          $foo84 = "msg/m_croatian.wnry"
          $foo85 = "CMnQ,OOr"
          $foo86 = "swprintf"
          $foo87 = "SetFileAttributesW"
          $foo88 = "msg/m_czech.wnryn"
          $foo89 = "O|x8+^_"
          $foo90 = "HeapAlloc"
          $foo91 = "__setusermatherr"
          $foo92 = "GetWindowsDirectoryW"
          $foo93 = "115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn"
          $foo94 = "LocalFileTimeToFileTime"
          $foo95 = "3/Vq9	="
          $foo96 = "CryptAcquireContextA"
          $foo97 = "Jo7eQX%"
          $foo98 = "FindResourceA"
          $foo99 = "'B;1?5s"
          $foo100 = "IsBadReadPtr"
          $foo101 = "GetExitCodeProcess"
          $foo102 = "`.rdata"
          $foo103 = "#`?@/9P"
          $foo104 = "GetTempPathW"
          $foo105 = "invalid bit length repeat"
          $foo106 = "MSVCRT.dll"
          $foo107 = "o%%Jr..\\$"
          $foo108 = "Global\\MsWinZonesCacheCounterMutexA"
          $foo109 = "!`7RNkv"
          $foo110 = "__p___argc"
          $foo111 = "SetCurrentDirectoryW"
          $foo112 = "oversubscribed literal/length tree"
          $foo113 = "[l~y2U="
          $foo114 = "msg/m_greek.wnry4n"
          $foo115 = "invalid block type"
          $foo116 = "<` Xu9g"
          $foo117 = "GetNativeSystemInfo"
          $foo118 = "CloseServiceHandle"
          $foo119 = "incomplete distance tree"
          $foo120 = "S	Q+c@x"
          $foo121 = "8d62ro/"
          $foo122 = "e	];F[p"
          $foo123 = "$@^ Y+kCM3"
          $foo124 = "X(N.K&9"
          $foo125 = "LeaveCriticalSection"
          $foo126 = "msg/m_bulgarian.wnry"
          $foo127 = "B~WJLuC"
          $foo128 = "invalid window size"
          $foo129 = "msg/m_dutch.wnry9"
          $foo130 = "GetCurrentDirectoryA"
          $foo131 = "Hy}V2l0e"
          $foo132 = "xxJo%%\\r..8$"
          $foo133 = "NLc>zQy"
          $foo134 = "=iF-s4\"t"
          $foo135 = "GetFileAttributesA"
          $foo136 = "_initterm"
          $foo137 = "2{0ONU	T8"
          $foo138 = "M{_rKG	C"
          $foo139 = "4XI\"whG"
          $foo140 = "DeleteCriticalSection"
          $foo141 = "b.wnryP8"
          $foo142 = "GetFileSize"
          $foo143 = "GetFileAttributesW"
          $foo144 = "md)(:--"
          $foo145 = "WNcry@2ol7"
          $foo146 = "empty distance tree with lengths"
          $foo147 = "SizeofResource"
          $foo148 = "CopyFileA"
          $foo149 = "uo\"usd/"
          $foo150 = "ciC [/K"
          $foo151 = "$0vJ<T9"
          $foo152 = "icacls . /grant Everyone:F /T /C /Q"
          $foo153 = "CryptDestroyKey"
          $foo154 = "oversubscribed distance tree"
          $foo155 = "MoveFileExW"
          $foo156 = "KfmZ@9q"
          $foo157 = "TerminateProcess"
          $foo158 = "stream end"
          $foo159 = "c.wnry%"
          $foo160 = "vi#<!d*S"
          $foo161 = "pfgGL`R"
          $foo162 = "_XcptFilter"
          $foo163 = "RegCreateKeyW"
          $foo164 = "[wS#C^6"
          $foo165 = "file error"
          $foo166 = ">nuGl=Cme4"
          $foo167 = "Microsoft Enhanced RSA and AES Cryptographic Provider"
          $foo168 = "msg/m_filipino.wnry"
          $foo169 = "incomplete dynamic bit lengths tree"
          $foo170 = ".?AVexception@@"
          $foo171 = "b=htZo&f"
          $foo172 = "KERNEL32.dll"
          $foo173 = "msg/m_chinese (simplified).wnryR9"
          $foo174 = "&&Lj66lZ??~A"
          $foo175 = "#E.(`MW"
          $foo176 = "cmd.exe /c \"%s\""
          $foo177 = "j_1lTo`"
          $foo178 = "stream error"
          $foo179 = "&Lj&6lZ6?~A?"
          $foo180 = "WS2_32.dll"
          $foo181 = "SystemTimeToFileTime"
          $foo182 = "- unzip 0.15 Copyright 1998 Gilles Vollant"
          $foo183 = "??0exception@@QAE@ABV0@@Z"
          $foo184 = ",4$8'9-6:.6$1#?*XhHpSeA~NrZlE"
          $foo185 = "CloseHandle"
          $foo186 = "??2@YAPAXI@Z"
          $foo187 = "SetFileTime"
          $foo188 = "|~}%.15"
          $foo189 = "GetProcessHeap"
          $foo190 = "SE{^QC4"
          $foo191 = "Df\"\"T~**;"
          $foo192 = "wsprintfA"
          $foo193 = "GetModuleFileNameA"
          $foo194 = "RegQueryValueExA"
          $foo195 = "2/O-_.X8w.+"
          $foo196 = "s<,kX5k"
          $foo197 = "4I_,eJi"
          $foo198 = "CreateServiceA"
          $foo199 = "f\"\"D~**T"
          $foo200 = "_controlfp"
          $foo201 = "incompatible version"
          $foo202 = "dV22tN::"
          $foo203 = "_-TPsPUv: V"
          $foo204 = "IyEf [%"
          $foo205 = "__set_app_type"
          $foo206 = "InitializeCriticalSection"
          $foo207 = "Hjz%3(0"
          $foo208 = ".Vy_Fdk"
          $foo209 = "'Oh'-o]"
          $foo210 = "qr=_os*"
          $foo211 = ",MF3j;2@"
          $foo212 = "need dictionary"
          $foo213 = "CreateDirectoryA"
          $foo214 = "pq\"b\"V1"
          $foo215 = "=XnFQ-Il"
          $foo216 = "x%Jo%.\\r."
          $foo217 = "GetProcAddress"
          $foo218 = "CryptEncrypt"
          $foo219 = "MSVCP60.dll"
          $foo220 = "6P>YK^$r"
          $foo221 = "__p___argv"
          $foo222 = "sprintf"
          $foo223 = "MF2E0UG"
          $foo224 = "KPeJr}F"
          $foo225 = "CryptGenKey"
          $foo226 = "__getmainargs"
          $foo227 = "`1^9tdb"
          $foo228 = "mK~}k=P"
          $foo229 = "ADVAPI32.dll"
          $foo230 = "GetComputerNameW"
          $foo231 = "!This program cannot be run in DOS mode."
          $foo232 = "WANACRY!"
          $foo233 = "incorrect header check"
          $foo234 = "_mbsstr"
          $foo235 = "Le\"zE^f1"
          $foo236 = "msg/m_german.wnry"
          $foo237 = "\"Df\"*T~*"
          $foo238 = "SHELL32.dll"
          $foo239 = "8,4$6'9-$:.6*1#?pXhH~SeAlNrZbE"
          $foo240 = "LockResource"
          $foo241 = "#cMe&(;[Ip"
          $foo242 = "advapi32.dll"
          $foo243 = "Lj&&lZ66~A??"
          $foo244 = "L3koq_ >"
          $foo245 = "??1type_info@@UAE@XZ"
          $foo246 = "msg/m_danish.wnry"
          $foo247 = "^Md]\"lN"
          $foo248 = "EGBkV6\"rnL9"
          $foo249 = "?-3t/''"
          $foo250 = "GetStartupInfoA"
          $foo251 = "tJ9@0O("
          $foo252 = "!A$U>=+"
          $foo253 = "2dV2:tN:"
          $foo254 = "tlHt Ht"
          $foo255 = "9d|!]`["
          $foo256 = "GlobalFree"
          $foo257 = "V22dN::t"
          $foo258 = "nyMZ?%g;"
          $foo259 = "QeFbF~TiKwZ"
          $foo260 = "[d+?8d["
          $foo261 = "EnterCriticalSection"
          $foo262 = "LoadResource"
          $foo263 = "msg/m_finnish.wnry~"
          $foo264 = "\"\"Df**T~"
          $foo265 = "kEs##Q^!"
          $foo266 = "r;#r7iS|1"
          $foo267 = "s]R\",XC("
          $foo268 = "CreateFileA"
          $foo269 = "??3@YAXPAX@Z"
          $foo270 = "VirtualFree"
          $foo271 = "CreateProcessA"
          $foo272 = "invalid literal/length code"
          $foo273 = "oversubscribed dynamic bit lengths tree"
          $foo274 = "E65etRI\\v4"
          $foo275 = "SetLastError"
          $foo276 = "*4q4[`V"
          $foo277 = "+[\\_JQ}"
          $foo278 = "\"t=.|Vbq-"
          $foo279 = "invalid stored block lengths"
          $foo280 = ":95e`Il"
          $foo281 = "$8,4-6'96$:.?*1#HpXhA~SeZlNrSbE"
          $foo282 = "=1azT)8^y"
          $foo283 = "__p__fmode"
          $foo284 = "buffer error"
          $foo285 = "^Ml,L;0"
          $foo286 = "!#pHA[P"
          $foo287 = "*@~CS%1"
          $foo288 = "~|c<caKm2"
          $foo289 = "C77nYmm"
          $foo290 = "_adjust_fdiv"
          $foo291 = "7#z y,:"
          $foo292 = "e\".E~^G"
          $foo293 = "pp|B>>q"
          $foo294 = "SetFilePointer"
          $foo295 = "RegCloseKey"
          $foo296 = "strrchr"
          $foo297 = "USER32.dll"
          $foo298 = "too many length or distance symbols"

   condition:
       $a at 0 and all of them

}